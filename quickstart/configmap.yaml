hostname: bigbang.dev

flux:
  interval: 1m
  rollback:
    cleanupOnFail: false

clusterAuditor:
  enabled: false

gatekeeper:
  values:
    replicas: 1

istio:
  git:
    tag: "1.7.3-bb.10"
  values:
    kiali:
      dashboard:
        auth:
          strategy: anonymous

    ingressGateway:
      type: LoadBalancer

    extraIngressGateways:
    - name: il4-ingressgateway
      type: LoadBalancer
      k8s:
        hpaSpec:
          minReplicas: 1
          maxReplicas: 3
        serviceAnnotations:
          # Ensure mission apps have internal load balancer only (classic LB)
          service.beta.kubernetes.io/aws-load-balancer-internal: "true"
          # Enable cross zone load balancing
          service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"
      labels:
        app: il4-gateway
        istio: il4-ingressgateway
      ports:
        # NOTE: Below are ripped directly from istio gateway helm chart defaults: https://github.com/istio/istio/blob/master/manifests/charts/gateways/istio-ingress/values.yaml
        ## You can add custom gateway ports in user values overrides, but it must include those ports since helm replaces.
        # Note that AWS ELB will by default perform health checks on the first port
        # on this list. Setting this to the health check port will ensure that health
        # checks always work. https://github.com/istio/istio/issues/12503
        - port: 15022
          targetPort: 15021
          name: status-port
          protocol: TCP
        - port: 8080
          targetPort: 8080
          name: http2
          protocol: TCP
        - port: 8443
          targetPort: 8443
          name: https
          protocol: HTTPS
        - port: 15013
          targetPort: 15012
          name: tcp-istiod
          protocol: TCP
        # This is the port where sni routing happens
        - port: 15444
          targetPort: 15443
          name: tls
          protocol: TCP
    - name: il2-ingressgateway
      type: LoadBalancer
      k8s:
        hpaSpec:
          minReplicas: 1
          maxReplicas: 3
        serviceAnnotations:
          # Ensure mission apps have internal load balancer only (classic LB)
          service.beta.kubernetes.io/aws-load-balancer-internal: "true"
          # Enable cross zone load balancing
          service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"
      labels:
        app: il2-gateway
        istio: il2-ingressgateway
      ports:
        # NOTE: Below are ripped directly from istio gateway helm chart defaults: https://github.com/istio/istio/blob/master/manifests/charts/gateways/istio-ingress/values.yaml
        ## You can add custom gateway ports in user values overrides, but it must include those ports since helm replaces.
        # Note that AWS ELB will by default perform health checks on the first port
        # on this list. Setting this to the health check port will ensure that health
        # checks always work. https://github.com/istio/istio/issues/12503
        - port: 15022
          targetPort: 15021
          name: status-port
          protocol: TCP
        - port: 80
          targetPort: 8080
          name: http2
          protocol: TCP
        - port: 443
          targetPort: 8443
          name: https
          protocol: HTTPS # TCP errors curl because of TLS version issues
        - port: 15013
          targetPort: 15012
          name: tcp-istiod
          protocol: TCP
        # This is the port where sni routing happens
          - port: 15444
          targetPort: 15443
          name: tls
          protocol: TCP


logging:
  enabled: false

monitoring:
  enabled: false

twistlock:
  enabled: false
  values:
    console:
      persistence:
        size: 5Gi